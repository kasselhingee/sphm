# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' @describeIn SvMF_varlinks Aligns the columns of the Mobius-link rotation matrix `P` for the mean to the columns of G. Note that the first column of the returned G is the given mean. Returns the matrix G.
alignedGcpp <- function(m, P) {
    .Call('_sphm_alignedGcpp', PACKAGE = 'sphm', m, P)
}

#' The log-likelihood of a SvMF Sphere-Sphere Regression with Mobius Mean Link and Variance Axes Aligned with P.
#' @description Three functions in a format compatible with `tapefun`. A difficulty is that the P matrix needs and SVD to get out of the Omega parameterisation so two functions for alternating between optimising the mean (with `kappa` and `a` fixed, and `G` aligned to a fixed `P`) and optimising a, with the mean fixed and concentration fixed, and updating `P` inbetween.
#' @param vec For `_alignedGmean`: A parameter vector specifying the mean via the Omega vectorisation.
#' @param dyn For `_alignedGmean`: A p+1+p*p length vector of kappa, then a1, a2, ..., then P as a vector of stacked columns.
#' @param p_in The dimension p
#' @param yx The observations and covariates cbind together as row vectors
ll_SvMF_S2S_alignedGmean <- function(vec, dyn, p_in, yx) {
    .Call('_sphm_ll_SvMF_S2S_alignedGmean', PACKAGE = 'sphm', vec, dyn, p_in, yx)
}

#' @param vec For `_alignedGa`: A p-1 vector of a2, a3, ...
#' @param dyn For `_alignedGa`: A vector of kappa then a1
#' @param pOmegavec For `_alignedGa`: A vector of p then the Omega vectorisation. Due to an SVD to extract P from Omega vec, taping the dependence on Omega would be unreliable.
ll_SvMF_S2S_alignedGa <- function(vec, dyn, pOmegavec, yx) {
    .Call('_sphm_ll_SvMF_S2S_alignedGa', PACKAGE = 'sphm', vec, dyn, pOmegavec, yx)
}

#' @param k For `_alignedGk`: A parameter vector specifying the concentration k
#' @param dyn For `_alignedGk`: A p*q + p + p*p length vector of Omegavec, then a1, a2, ..., then P as a vector of stacked columns.
#' The P and Omega are provided seperately because of the non-smooth nature of SVD.
ll_SvMF_S2S_alignedGk <- function(k, dyn, p_in, yx) {
    .Call('_sphm_ll_SvMF_S2S_alignedGk', PACKAGE = 'sphm', k, dyn, p_in, yx)
}

ldSvMF_cann <- function(y, k, a, G) {
    .Call('_sphm_ldSvMF_cann', PACKAGE = 'sphm', y, k, a, G)
}

ldSvMF_muV <- function(y, k, m, a1, V) {
    .Call('_sphm_ldSvMF_muV', PACKAGE = 'sphm', y, k, m, a1, V)
}

meanlinkS2Scpp <- function(x, vec, p) {
    .Call('_sphm_meanlinkS2Scpp', PACKAGE = 'sphm', x, vec, p)
}

#' Preliminary Objective in the style of the `generalfunction` class:
#' @param yx is the response and covariates *cbind* together. Each row an observation.
#' @param dyn is a zero length vector
#' @param p is required to separate yx and omvec. It is passed as a double for compatiblility witn generalfunction, so will have to be rounded to a integer within the function
#' @param dyn ignored
pobjS2Scpp <- function(omvec, dyn, p_in, yx) {
    .Call('_sphm_pobjS2Scpp', PACKAGE = 'sphm', omvec, dyn, p_in, yx)
}

OmegaS2S_constraints <- function(vec, p) {
    .Call('_sphm_OmegaS2S_constraints', PACKAGE = 'sphm', vec, p)
}

#' Function for taping a general function. The function must have signature
#' `veca1 fun(const veca1 & independent, const veca2 & dynamic, const vecd & constvec, const matd & constmat)`.
#' Differentiation of `fun` will occur with respect to the independent arguments. The taping will keep of dependence on the dynamic arguments so that the value of the dynamic arguments can be changed in the tape. The constants (constvec and constmat) will be baked into the tape (to change these constants `tapefun` will have to be called again.
#' 
#' If some of the arguments are unwanted, I'm hoping I can write the function so that vectors of length zero are okay.
#'
#' @param fun A function with the correct signature.
#' @param ind_t The value of the independent argument to use for taping.
#' @param dyn_t The value of the dynamic argument to use for taping.
#' @param constants The value of the constants argument.
NULL

#' Tape using a function name in function_map 
#' @param func_name Name of function to tape. Name must be in the internal `function_map` object.
tape_namedfun <- function(func_name, ind_t, dyn_t, constvec, constmat) {
    .Call('_sphm_tape_namedfun', PACKAGE = 'sphm', func_name, ind_t, dyn_t, constvec, constmat)
}

#' @describeIn tape_namedfun Tape using a pointer to a function created by RcppXPtrUtils::cppXPtr
#' @param funptr A pointer to a function created by RcppXPtrUtils::cppXPtr
tape_funptr <- function(funptr, ind_t, dyn_t, constvec, constmat) {
    .Call('_sphm_tape_funptr', PACKAGE = 'sphm', funptr, ind_t, dyn_t, constvec, constmat)
}

