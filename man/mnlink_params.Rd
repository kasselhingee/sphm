% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Mobius_link_parameterisations.R
\name{mnlink_params}
\alias{mnlink_params}
\alias{mnlink_cann}
\alias{as_mnlink_cann}
\alias{mnlink_Omega}
\alias{as_mnlink_Omega}
\title{Parameterisation Classes for the Scaled Mobius Mean Link}
\usage{
mnlink_cann(
  P,
  Bs = NULL,
  Qs = NULL,
  Be = NULL,
  Qe = NULL,
  ce = NULL,
  check = TRUE
)

as_mnlink_cann(obj)

mnlink_Omega(
  p1,
  qs1 = vector("numeric", 0),
  Omega,
  qe1 = vector("numeric", 0),
  ce = vector("numeric", 0),
  check = TRUE
)

as_mnlink_Omega(obj)
}
\arguments{
\item{P}{Final rotation matrix on the response sphere: a p x p orthonormal matrix with positive determinant.}

\item{Bs}{Scaling matrix for spherical covariates: a (p-1) x (p-1) diagonal matrix with elements between zero and one ordered in decreasing size. \code{NULL} if no Sph covariates.}

\item{Qs}{The qs x p rotation-like matrix \code{R_s} for rotating the spherical covariate vector. \code{NULL} if no Sph covariates.}

\item{Be}{Scaling matrix for Euclidean covariates: a (p-1) x (p-1) diagonal matrix with elements between zero and one ordered in decreasing size. \code{NULL} if no Euc covariates.}

\item{Qe}{The qe x p rotation-like matrix \code{R_e} for rotating the Euclidean covariate vector. \code{NULL} if no Euc covariates.}

\item{ce}{The value of \eqn{c_e}.}

\item{p1}{First column of the P matrix (vector of length \code{p})}

\item{qs1}{First column of the Qs matrix (vector of length \code{qs}). \code{NULL} if no Sph covariates.}

\item{Omega}{A \code{p} by \code{qe + qs} matrix representing
\deqn{\Omega = [\Omega_s \Omega_e] = [P^* B_s {Q_s^*}^T \,   P^* B_e {Q_e^*}^T]}}

\item{qe1}{First column of the Qe matrix (vector of length \code{qe}). \code{NULL} if no Euc covariates.}
}
\description{
Parameterisations of the link functions.
These methods, create, check and convert between parameterisations of the mean link.
Actual mean link calculations are performed by other functions.
}
\section{Functions}{
\itemize{
\item \code{mnlink_cann()}: Represent the parameters of the Mobius mean link \code{\link[=mnlink]{mnlink()}} using the canonical form.

\item \code{as_mnlink_cann()}: Represent the parameters of the Mobius mean link \code{\link[=mnlink]{mnlink()}} using the canonical form.

\item \code{mnlink_Omega()}: Represent the parameters of the Mobius mean link \code{\link[=mnlink]{mnlink()}} using the Omega form.

\item \code{as_mnlink_Omega()}: Represent the parameters of the Mobius mean link \code{\link[=mnlink]{mnlink()}} using the Omega form.

}}
\section{Cannonical Parameterisation}{
The parameters here are for a mean link defined as
\deqn{\mu_{SpEuc}(x) = P\mathcal{S}^{[-1]}\left(B_s \mathcal{S}(Q_s^\top x_s)  +  \frac{B_e(Q_e[,-1]^\top x_e}{Q_e[,1]^\top x_e + c_e}\right)}
where \eqn{\mu(x)} is a p-length unit vector,
\eqn{x_s} is a \code{qs}-length unit vector,
\eqn{x_e} is a \code{qe}-length vector,
\code{P} is a p x p rotation matrix,
\code{Qs} is a \verb{qs x p} orthonormal matrix (\code{t(Qs) \%*\% Qs == diag(p)}),
\code{Bs} is a diagonal matrix (p-1) x (p-1) matrix,
\code{Be} is a diagonal matrix (p-1) x (p-1) matrix,
\code{Qs} is a \verb{qe x p} orthonormal matrix,
\code{ce} is a real-valued number.
The Euclidean covariate in this link is essentially transformed by \eqn{B_e\mathcal{S}\left(Q_e^\top x/c_1 \right)}, thus we call this link the \code{SpEuc} link.

The \code{SpEuc} link above is slightly more flexible than the link function defined at the start of "Regression for spherical responses with linear and spherical covariates using a scaled link function" manuscript.
The link in Equation (1) from that manuscript is
\deqn{\mu_{LinEuc}(x) = P\mathcal{S}^{[-1]}\left(B_s \mathcal{S}(Q_s^\top x_s)  +  B_e(Q_e[,-1]^\top x_e\right),}
which can be written as \eqn{\mu_{SpEuc}} with an extra zero-valued Euclidean covariate as the first covariate and fixing \eqn{Q_e[,1]=q_{e1}} to be \verb{(1, 0, ...)} to match the index of the constant covariate and setting \code{ce=1}.
This is the \code{LinEuc} (for linear Euclidean) link form.
}

\section{Omega Parameterisation}{
The link functions are simplified by writing \eqn{\Omega_s = P^* B_s {Q_s^*}^T} and \eqn{\Omega_e = P^* B_e {Q_e^*}^T}, \eqn{\Omega = [\Omega_s \,\, \Omega_e]}.
This parameterisation helps optimisation as optimisation in Stiefel manifolds is harder than other spaces, and also reflects the sign ambiguity of columns of P with the matching columns of \code{Qe} and \code{Qs}.
}

