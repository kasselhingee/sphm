% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Mobius_link.R
\name{mnlink}
\alias{mnlink}
\title{Calculate the Mean Given Covariates}
\usage{
mnlink(xs = NULL, xe = NULL, param = NULL, check = TRUE)
}
\arguments{
\item{xs}{A matrix of row-vectors of the spherical covariate.}

\item{xe}{A matrix of row-vectors of the Euclidean covariates.}

\item{param}{Parameters of the mean link. As an object of class "mnlink_Omega" or "mnlink_cann". See \code{\link{mnlink_params}}.}
}
\description{
Implements mean link:
\deqn{\mu(x) = P\mathcal{S}^{-1}\left(B_s \mathcal{S}(Q_s^\top x_s)  +  \frac{B_e\left(Q_e[,-1]^\top x_e\right)}{Qe[,1]^\top x_e + c_e}\right).}
}
\details{
This general form of the mean link encompases the primary form of the mean link in "Regression for spherical responses with linear and spherical covariates using a scaled link function" and a more general form that uses the a stereographic-like projection of the Euclidean covariates.
See \code{\link{mnlink_params}} for further details.

If \code{param} is of class "mnlink_Omega" then means are computed as
\deqn{\mu(x) = \frac{(1-\|\tilde{y}(x)\|^2) P[,1] + 2 \tilde{y}(x)}{1+\|\tilde{y}(x)\|^2}}
where
\deqn{\tilde{y}(x) = \frac{\Omega_s x_s}{1+Q_s[,1]^\top x_s} + \frac{\Omega_e x_e}{c_e+{Q_e[,1]}^\top x_e}}
and \eqn{x_s} and \eqn{x_e} are the spherical and Euclidean covariate.
}
