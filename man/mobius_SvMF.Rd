% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Mobius_SvMF.R
\name{mobius_SvMF}
\alias{mobius_SvMF}
\title{SvMF Regression with Scaled Mobius Link and Parallel Transported Axes}
\usage{
mobius_SvMF(
  y,
  xs,
  xe,
  mean = NULL,
  k = NULL,
  a = NULL,
  G0 = NULL,
  G0reference = NULL,
  G01behaviour = "p1",
  type = "LinEuc",
  fix_qs1 = FALSE,
  fix_qe1 = (type == "LinEuc"),
  intercept = TRUE,
  doprelim = TRUE,
  ...
)
}
\arguments{
\item{y}{Response data on a sphere}

\item{xs}{Covariate data on a sphere}

\item{xe}{Covariate data in Euclidean Space}

\item{mean}{Parameters for the mean link, used as a starting guess for the preliminary vMF regression if \code{doprelim = TRUE}.}

\item{k}{Starting concentration. If omitted, then concentration of the preliminary vMF regression is used.}

\item{a}{The scaling vector \code{a}. \code{a[1]} is a fixed tuning parameter and the remainining is used as an initial value for the optimisation. If omitted, then a moment estimate using residuals of from the preliminary vMF regression is used.}

\item{G0}{A \verb{p x p} rotation matrix specifying the starting guess of the axes of the SvMF distribution. G0 should have positive determinant because in the estimation routine G0 or parts of G0 are representented using Cayley transforms. If omitted, then a moment estimate using residuals of from the preliminary vMF regression is used.}

\item{G0reference}{A \verb{p x p} rotation matrix specifying a set of coordinates with which to represent G0 for the estimation. This is because internally \code{G0} or \code{G0[,-1]} is represented using a Cayley transform, which performs better the closer the matrix is to the identity. Ideally the columns of \code{G0reference} will be close to the best \code{G0}.}

\item{G01behaviour}{"p1" identifies \code{G0[,1]} with \code{p1}. "fixed" fixes \code{G0[,1]} to its initial value. "free" allows \code{G0[,1]} to be estimated freely.}

\item{type}{Specify the link type ("SpEuc" or "LinEuc")}

\item{fix_qs1}{Fix qs1 to the starting values.}

\item{fix_qe1}{Fix qe1 to the starting values - typically used in when "LinEuc" link used.}

\item{intercept}{Include an intercept (Euclidean covariate that is always \code{1}).}

\item{doprelim}{When \code{FALSE} the preliminary von Mises-Fisher regression and subsequent moment estimation of \code{a} and \code{G0} is omitted. The provided parameters are used as the initial values for an optimisation of all parameters of the SvMF regression all together using \code{\link[nloptr:nloptr]{nloptr::nloptr()}}.}

\item{...}{Named optional arguments passed as a list to the \code{opts} argument of \code{\link[nloptr:nloptr]{nloptr::nloptr()}}.}
}
\value{
A list:
\describe{
\item{mean}{Estimated mean parameters}
\item{k}{Estimated concentration parameter k}
\item{a}{Estimated vector of scales \code{a} (except \code{a[1]} which is fixed)}
\item{G0}{Estimated base location and symmetry axes.}
\item{obj}{Final objective value from NLopt}
\item{nlopt}{NLopt optimization result object}
\item{y}{Response data}
\item{xs}{Spherical covariate values}
\item{xe}{Euclidean covariate values (including any automatically added columns like dummy zeros and an intercept)}
\item{pred}{Predicted values on sphere}
\item{rresids, rresids_I}{Residuals rotated (by parallel transport) to the north pole}
\item{rresids_G0, rresids_std}{Residuals rotated to \code{G0[,1]} and expressed according to the axes given by \code{G0[,-1]}. \code{rresids_std} additionaly scales the rotated residuals by \eqn{\sqrt{k} a[1]/a[j]}.}
\item{dists}{Residual geodesic distances (geodesic distance between predicted value and observed value)}
\item{DoF}{Degrees of freedom of the optimisation}
\item{AIC}{Akaike Information Criterion}
\item{lLik}{Log-likelihood}
\item{initial}{Initial values}
\item{preest}{Results of the preliminary vMF regression}
}
}
\description{
Performs regression for spherical response data with a scaled Mobius mean link and scale von Mises-Fisher error distribution (SvMF).
}
\details{
The mean is assumed to follow \code{\link[=mnlink]{mnlink()}}.
The concentration and scaling in the SvMF is assumed constant across observations.
The symmetry axes of the SvMF at location \eqn{\mu} are assumed to be the result of parallel transport along the geodesic of axes \code{G0[,-1]} from  \code{G0[,1]} to \eqn{\mu}. The axis at this base location \code{G0[,1]} are estimated.

Unless requested by \code{doprelim = FALSE}, a preliminary regression using a vMF error distribution is performed.

When p!=3, the optimisation first approximates the normalising constant of the vMF distribution, then the concentration is optimised seperately.
}
